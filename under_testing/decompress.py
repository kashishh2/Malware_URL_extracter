import pefile
import re
import pandas as pd

def extract_urls_from_exe(filename):
    urls = []
    pe = pefile.PE(filename)
    for section in pe.sections:
        section_data = section.get_data()
        urls += re.findall(r'(https?://\S+|www\.\S+|\S+\.[a-zA-Z]{2,})', section_data.decode(errors='ignore'))
    return urls

def write_urls_to_csv(urls, filename):
    print(urls)
    df = pd.DataFrame({'URL': urls})
    df.to_csv(filename, index=False)

# Example usage
url = input("Enter the URL:")
urls = extract_urls_from_exe(url)
write_urls_to_csv(urls, "output_file.csv")


import re

# Define the regular expression for URLs
url_regex = re.compile(r'^(?:https?|www)\:\/\/.*\.(?:co|com|xyz|gov)$', re.MULTILINE)

# Open the text file and read its contents
with open('filename.txt', 'r') as f:
    contents = f.read()

# Use the regex to find all URLs in the text
urls = url_regex.findall(contents)

# Print the URLs that were found
print(urls)


